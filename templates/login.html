<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Crowd Sense Detection - Admin Login</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet" />
    <!-- SweetAlert2 for Toaster Notifications -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        /* ===== Animations ===== */
        @keyframes typing {
            0% { width: 0; }
            40% { width: 100%; }
            50% { width: 100%; }
            90% { width: 0; }
            100% { width: 0; }
        }
        @keyframes blink-caret {
            0%, 39%, 50%, 90%, 100% { border-color: white; }
            40%, 89% { border-color: transparent; }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(25px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes marquee-scroll {
            from { transform: translateX(100%); }
            to { transform: translateX(-100%); }
        }

        /* ===== General ===== */
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            height: 100vh;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* ===== 3D Background - ENORMOUS & DRAMATIC ===== */
        .background-container {
            position: absolute;
            top: -10%; left: -10%;
            width: 120%; height: 120%;
            background-image: url("{{ url_for('serve_template_image', filename='Crowd-Control-Analytics.jpg') }}");
            background-size: cover;
            background-position: center;
            filter: blur(8px) brightness(0.5) contrast(1.2);
            transform: perspective(2000px) rotateX(5deg) rotateY(-2deg) scale(1.2);
            z-index: 0;
            animation: background3D 25s ease-in-out infinite;
        }
        
        @keyframes background3D {
            0%, 100% {
                transform: perspective(2000px) rotateX(5deg) rotateY(-2deg) scale(1.2) translateZ(0);
            }
            25% {
                transform: perspective(2000px) rotateX(-3deg) rotateY(3deg) scale(1.25) translateZ(50px);
            }
            50% {
                transform: perspective(2000px) rotateX(4deg) rotateY(-4deg) scale(1.3) translateZ(100px);
            }
            75% {
                transform: perspective(2000px) rotateX(-2deg) rotateY(2deg) scale(1.22) translateZ(30px);
            }
        }
        
        /* 3D Depth Layers */
        .depth-layer-1 {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: radial-gradient(circle at 30% 50%, rgba(52, 152, 219, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 70% 50%, rgba(231, 76, 60, 0.2) 0%, transparent 50%);
            transform: perspective(1500px) translateZ(100px);
            z-index: 1;
            animation: depthFloat 20s ease-in-out infinite;
        }
        
        .depth-layer-2 {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.15) 0%, rgba(231, 76, 60, 0.15) 100%);
            transform: perspective(1800px) translateZ(200px) rotateX(10deg);
            z-index: 1;
            animation: depthFloat2 18s ease-in-out infinite;
        }
        
        @keyframes depthFloat {
            0%, 100% {
                transform: perspective(1500px) translateZ(100px) rotateX(0deg);
            }
            50% {
                transform: perspective(1500px) translateZ(150px) rotateX(5deg);
            }
        }
        
        @keyframes depthFloat2 {
            0%, 100% {
                transform: perspective(1800px) translateZ(200px) rotateX(10deg) rotateY(0deg);
            }
            50% {
                transform: perspective(1800px) translateZ(250px) rotateX(8deg) rotateY(5deg);
            }
        }
        
        /* 3D Particle Effect - ENHANCED */
        .particles-3d {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 2;
            overflow: hidden;
            perspective: 2000px;
        }
        
        .particle {
            position: absolute;
            border-radius: 50%;
            animation: float3D 20s infinite ease-in-out;
            box-shadow: 0 0 20px rgba(52, 152, 219, 1), 0 0 40px rgba(231, 76, 60, 0.6);
        }
        
        .particle.small {
            width: 3px;
            height: 3px;
            background: rgba(255, 255, 255, 0.8);
        }
        
        .particle.medium {
            width: 6px;
            height: 6px;
            background: rgba(52, 152, 219, 0.9);
        }
        
        .particle.large {
            width: 10px;
            height: 10px;
            background: rgba(231, 76, 60, 0.7);
        }
        
        @keyframes float3D {
            0% {
                transform: translate3d(0, 0, 0) rotateX(0deg) rotateY(0deg) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translate3d(10vw, 10vh, 50px) rotateX(45deg) rotateY(45deg) scale(1);
            }
            50% {
                transform: translate3d(50vw, 50vh, 300px) rotateX(180deg) rotateY(180deg) scale(1.5);
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translate3d(100vw, -100vh, 500px) rotateX(360deg) rotateY(360deg) scale(0.3);
                opacity: 0;
            }
        }
        
        /* 3D Geometric Shapes */
        .shape-3d {
            position: absolute;
            border: 2px solid rgba(52, 152, 219, 0.4);
            animation: shape3D 30s infinite ease-in-out;
            z-index: 1;
        }
        
        .shape-3d.cube {
            width: 100px;
            height: 100px;
            transform: perspective(2000px) rotateX(45deg) rotateY(45deg);
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.2), rgba(231, 76, 60, 0.2));
        }
        
        .shape-3d.triangle {
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 87px solid rgba(52, 152, 219, 0.3);
            border-top: none;
        }
        
        @keyframes shape3D {
            0%, 100% {
                transform: perspective(2000px) translateZ(0) rotateX(0deg) rotateY(0deg);
            }
            33% {
                transform: perspective(2000px) translateZ(200px) rotateX(120deg) rotateY(120deg);
            }
            66% {
                transform: perspective(2000px) translateZ(400px) rotateX(240deg) rotateY(240deg);
            }
        }
        
        /* 3D Grid Overlay - ENHANCED */
        .grid-3d {
            position: absolute;
            top: -20%; left: -20%;
            width: 140%; height: 140%;
            z-index: 1;
            background-image: 
                linear-gradient(rgba(52, 152, 219, 0.15) 1px, transparent 1px),
                linear-gradient(90deg, rgba(52, 152, 219, 0.15) 1px, transparent 1px),
                linear-gradient(rgba(231, 76, 60, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(231, 76, 60, 0.1) 1px, transparent 1px);
            background-size: 80px 80px, 80px 80px, 40px 40px, 40px 40px;
            transform: perspective(2000px) rotateX(70deg) rotateY(-5deg) scale(1.5);
            animation: gridMove 25s linear infinite;
            pointer-events: none;
        }
        
        @keyframes gridMove {
            0% {
                transform: perspective(2000px) rotateX(70deg) rotateY(-5deg) scale(1.5) translateY(0) translateZ(0);
            }
            50% {
                transform: perspective(2000px) rotateX(65deg) rotateY(5deg) scale(1.6) translateY(80px) translateZ(100px);
            }
            100% {
                transform: perspective(2000px) rotateX(70deg) rotateY(-5deg) scale(1.5) translateY(160px) translateZ(0);
            }
        }
        
        /* 3D Light Rays */
        .light-rays {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(52, 152, 219, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(231, 76, 60, 0.25) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 60%);
            animation: lightRays 15s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes lightRays {
            0%, 100% {
                transform: perspective(1500px) rotateX(0deg) scale(1);
                opacity: 0.6;
            }
            50% {
                transform: perspective(1500px) rotateX(10deg) scale(1.2);
                opacity: 0.9;
            }
        }

        /* ===== Wrapper ===== */
        .page-wrapper {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%;
            max-width: 450px;
        }

        /* ===== Title ===== */
        .main-title {
            margin-bottom: 40px;
            animation: fadeIn 1s ease-out 0.5s both;
        }
        .main-title h1 {
            margin: 0;
            font-size: clamp(2em, 6vw, 4em);
            font-weight: 900;
            text-transform: uppercase;
            color: white;
            border-right: .15em solid white;
            overflow: hidden;
            white-space: nowrap;
            letter-spacing: .1em;
            text-shadow: 6px 6px 10px rgba(0, 0, 0, 0.7);
            animation: typing 10s steps(22, end) infinite, blink-caret 10s steps(22, end) infinite;
        }

        /* ===== Login Container ===== */
        .login-container {
            background-color: rgba(255, 255, 255, 0.92);
            padding: 35px 30px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
            text-align: center;
            animation: fadeIn 1s ease-out 1s both;
            width: 100%;
        }
        .login-container h2 {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 25px;
        }

        /* ===== Form Elements ===== */
        .form-group {
            margin-bottom: 20px;
            margin-left: 0;
            margin-right: 0;
            text-align: left;
        }
        .form-group label {
            color: #34495e;
            font-weight: 600;
            font-size: 14px;
            display: block;
            margin-bottom: 8px;
        }
        .form-group input {
            width: 100%;
            padding: 12px 14px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
            font-family: inherit;
            transition: all 0.3s;
            box-sizing: border-box;
            margin: 0;
        }
        .form-group input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
            background-color: #f8f9fa;
        }
        .form-group input:hover {
            border-color: #3498db;
        }

        .btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: none;
            color: #fff;
            font-size: 16px;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.25s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }

        /* Flash messages removed - using toaster notifications instead */

        /* ===== Marquee ===== */
        .marquee-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.45);
            padding: 10px 0;
            overflow: hidden;
            z-index: 3;
            color: rgba(255, 255, 255, 0.85);
        }
        .marquee-text {
            display: inline-block;
            animation: marquee-scroll 14s linear infinite;
            letter-spacing: 2px;
        }

        /* ===== Responsive ===== */
        @media (max-width: 480px) {
            .main-title h1 {
                font-size: 2em;
            }
            .login-container {
                padding: 25px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="background-container"></div>
    <div class="depth-layer-1"></div>
    <div class="depth-layer-2"></div>
    <div class="light-rays"></div>
    <div class="grid-3d"></div>
    <div class="particles-3d" id="particles"></div>
    <div class="shape-3d cube" style="top: 10%; left: 10%;"></div>
    <div class="shape-3d cube" style="top: 70%; left: 80%; animation-delay: 5s;"></div>
    <div class="shape-3d triangle" style="top: 30%; left: 70%; animation-delay: 10s;"></div>
    <div class="shape-3d triangle" style="top: 60%; left: 20%; animation-delay: 15s;"></div>

    <div class="page-wrapper">
        <div class="main-title">
            <h1>CROWD SENSE DETECTION</h1>
        </div>

        <div class="login-container">
            <h2>Admin Login</h2>

            <form method="POST" action="{{ url_for('login') }}" autocomplete="off">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required autocomplete="new-username" />
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required autocomplete="new-password" />
                </div>

                <button type="submit" class="btn">Login</button>
            </form>
        </div>
    </div>

    <div class="marquee-container">
        <p class="marquee-text">
            REAL-TIME ANALYTICS • ENHANCED SECURITY • SMART MONITORING • POWERED BY COMPUTER VISION
        </p>
    </div>

    <script>
        // Flash messages data from server
        const flashMessages = [
            {% with messages = get_flashed_messages(with_categories=True) %}
                {% if messages %}
                    {% for msg in messages %}
                        {% if msg[0] is defined and msg[1] is defined %}
                            {
                                category: '{{ msg[0] }}',
                                message: {{ msg[1]|tojson }}
                            }{% if not loop.last %},{% endif %}
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endwith %}
        ];
        
        // Clear username & password fields on page load
        window.onload = function() {
            document.getElementById("username").value = "";
            document.getElementById("password").value = "";
            
            // Create enhanced 3D particles with different sizes
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50; // Increased for more dramatic effect
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                const size = Math.random();
                if (size < 0.4) {
                    particle.className = 'particle small';
                } else if (size < 0.7) {
                    particle.className = 'particle medium';
                } else {
                    particle.className = 'particle large';
                }
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 15) + 's';
                particlesContainer.appendChild(particle);
            }
            
            // Show flash messages as toaster notifications
            flashMessages.forEach(function(msg) {
                if (msg && msg.category && msg.message) {
                    let icon = 'info';
                    let title = 'Info';
                    
                    if (msg.category === 'danger') {
                        icon = 'error';
                        title = 'Error';
                    } else if (msg.category === 'success') {
                        icon = 'success';
                        title = 'Success';
                    } else if (msg.category === 'warning') {
                        icon = 'warning';
                        title = 'Warning';
                    }
                    
                    Swal.fire({
                        icon: icon,
                        title: title,
                        text: msg.message,
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: msg.category === 'danger' || msg.category === 'warning' ? 4000 : 3000,
                        timerProgressBar: true,
                        background: '#1a1a1a',
                        color: '#fff',
                        customClass: {
                            popup: 'swal2-toast-custom'
                        }
                    });
                }
            });
        };
    </script>
    
    <style>
        /* Custom SweetAlert2 Toast Styling */
        .swal2-toast-custom {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.9), rgba(231, 76, 60, 0.9)) !important;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 20px rgba(52, 152, 219, 0.5);
            backdrop-filter: blur(10px);
        }
        
        .swal2-popup.swal2-toast {
            background: rgba(26, 26, 26, 0.95) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(52, 152, 219, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6), 0 0 30px rgba(52, 152, 219, 0.4);
        }
    </style>
</body>
</html>
